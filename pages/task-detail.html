<div class="task-detail-container">
    <div class="detail-header">
        <button class="back-btn" id="back-btn" onclick="window.navigateBack()">
            ‚Üê Back
        </button>
        <h1 class="task-title" id="task-title">Task Details</h1>
    </div>

    <div class="task-info-section">
        <div class="task-basic-info">
            <div class="info-item">
                <label>Task Name:</label>
                <span id="task-name">-</span>
            </div>
            <div class="info-item">
                <label>Due Date:</label>
                <span id="task-due-date">-</span>
            </div>
            <div class="info-item">
                <label>Created:</label>
                <span id="task-created-at">-</span>
            </div>
            <div class="info-item">
                <label>Last Updated:</label>
                <span id="task-updated-at">-</span>
            </div>
        </div>
        
        <div class="task-notes-section">
            <label>Notes:</label>
            <p id="task-notes">-</p>
        </div>
    </div>

    <div class="status-workflow-section">
        <h2>Status Workflow</h2>
        <div class="workflow-progress">
            <div class="workflow-steps">
                <div class="workflow-step clickable-step" data-status="ready_to_analyze" onclick="window.taskDetailManager.jumpToStatus('ready_to_analyze')" title="Click to jump to this status">
                    <div class="step-indicator"></div>
                    <span class="step-label">Ready to Analyze</span>
                </div>
                <div class="workflow-connector"></div>
                
                <div class="workflow-step clickable-step" data-status="complete_analyze" onclick="window.taskDetailManager.jumpToStatus('complete_analyze')" title="Click to jump to this status">
                    <div class="step-indicator"></div>
                    <span class="step-label">Complete Analyze</span>
                </div>
                <div class="workflow-connector"></div>
                
                <div class="workflow-step clickable-step" data-status="ready_to_development" onclick="window.taskDetailManager.jumpToStatus('ready_to_development')" title="Click to jump to this status">
                    <div class="step-indicator"></div>
                    <span class="step-label">Ready to Development</span>
                </div>
                <div class="workflow-connector"></div>
                
                <div class="workflow-step clickable-step" data-status="complete_development" onclick="window.taskDetailManager.jumpToStatus('complete_development')" title="Click to jump to this status">
                    <div class="step-indicator"></div>
                    <span class="step-label">Complete Development</span>
                </div>
                <div class="workflow-connector"></div>
                
                <div class="workflow-step clickable-step" data-status="ready_to_test" onclick="window.taskDetailManager.jumpToStatus('ready_to_test')" title="Click to jump to this status">
                    <div class="step-indicator"></div>
                    <span class="step-label">Ready to Test</span>
                </div>
                <div class="workflow-connector"></div>
                
                <div class="workflow-step clickable-step" data-status="test_done" onclick="window.taskDetailManager.jumpToStatus('test_done')" title="Click to jump to this status">
                    <div class="step-indicator"></div>
                    <span class="step-label">Test Done</span>
                </div>
                <div class="workflow-connector"></div>
                
                <div class="workflow-step clickable-step" data-status="ready_to_production" onclick="window.taskDetailManager.jumpToStatus('ready_to_production')" title="Click to jump to this status">
                    <div class="step-indicator"></div>
                    <span class="step-label">Ready to Production</span>
                </div>
                <div class="workflow-connector"></div>
                
                <div class="workflow-step clickable-step" data-status="production_done" onclick="window.taskDetailManager.jumpToStatus('production_done')" title="Click to jump to this status">
                    <div class="step-indicator"></div>
                    <span class="step-label">Production Done</span>
                </div>
            </div>
        </div>
        
        <div class="workflow-actions">
            <button class="btn btn-secondary" id="prev-status-btn" onclick="window.taskDetailManager.previousStatus()" disabled>
                ‚Üê Previous Stage
            </button>
            <button class="btn btn-primary" id="next-status-btn" onclick="window.taskDetailManager.nextStatus()">
                Next Stage ‚Üí
            </button>
        </div>
    </div>

    <div class="parent-idea-section">
        <h2>Parent Idea</h2>
        <div class="parent-idea-link">
            <button class="idea-link-button" id="parent-idea-button" onclick="window.taskDetailManager.openParentIdea()">
                <span class="idea-icon">üí°</span>
                <span id="parent-idea-text">Loading...</span>
                <span class="link-arrow">‚Üí</span>
            </button>
        </div>
    </div>

    <div class="subtasks-section">
        <h2>Subtasks</h2>
        <div class="task-management">
            <div class="task-controls">
                <button type="button" class="btn btn-secondary" onclick="window.subtaskGrid.addNewSubtask()">
                    + Add Subtask
                </button>
                <div class="subtasks-info">
                    <span id="subtasks-count">0 subtasks</span>
                    <span class="separator">‚Ä¢</span>
                    <span class="help-text">Click eye icon to view details</span>
                </div>
            </div>
            
            <div class="task-grid-container">
                <div class="task-grid" id="subtasks-task-grid">
                    <div class="task-grid-header">
                        <div class="grid-cell">Subtask Name</div>
                        <div class="grid-cell">Status</div>
                        <div class="grid-cell">Created</div>
                        <div class="grid-cell">Description</div>
                        <div class="grid-cell">Actions</div>
                    </div>
                    <div class="task-grid-body" id="subtasks-grid-body">
                        <!-- Subtasks will be dynamically added here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="task-actions">
        <button class="btn btn-secondary" onclick="window.taskDetailManager.editTask()">
            Edit Task
        </button>
        <button class="btn btn-danger" onclick="window.taskDetailManager.deleteTask()">
            Delete Task
        </button>
    </div>
</div>

<!-- Status Selector Modal -->
<div class="modal" id="status-selector-modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Change Task Status</h3>
            <button class="close-btn" onclick="window.taskDetailManager.closeStatusModal()">&times;</button>
        </div>
        <div class="status-options" id="status-options">
            <!-- Status options will be populated here -->
        </div>
    </div>
</div>

<!-- Create Subtask Modal -->
<div class="modal" id="create-subtask-modal" style="display: none;">
    <div class="modal-content create-subtask-modal-content">
        <div class="modal-header create-subtask-header">
            <h3>Create New Subtask</h3>
            <button class="close-btn" onclick="window.taskDetailManager.closeModal()">&times;</button>
        </div>
        <div class="form-section create-subtask-section">
            <form id="create-subtask-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="subtask-name">Subtask Name</label>
                        <input type="text" class="form-input" id="subtask-name" name="name" required>
                    </div>
                    <div class="form-group form-row">
                        <label class="form-label" for="subtask-description">Description</label>
                        <textarea class="form-textarea" id="subtask-description" name="description" rows="3"></textarea>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="window.taskDetailManager.closeModal()">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Create Subtask
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>